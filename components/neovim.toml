name = 'neovim'
from = 'base'

# https://github.com/neovim/neovim/releases
version = 'v0.4.4'

devDependencies = [
  'wget',
  'python3-pip',
]

build = """
wget \
  -O /tmp/nvim.appimage \
  'https://github.com/neovim/neovim/releases/download/{{VERSION}}/nvim.appimage'
chmod +x /tmp/nvim.appimage
/tmp/nvim.appimage --appimage-extract
rm /tmp/nvim.appimage

mv squashfs-root/usr/bin/nvim /usr/local/bin/nvim
mv squashfs-root/usr/share/nvim /usr/local/share/nvim
mkdir -p /usr/local/share/man/man1
mv squashfs-root/usr/man/man1/nvim.1 /usr/local/share/man/man1/nvim.1
rm -r squashfs-root

find /usr/local/share/nvim -type d -print0 | xargs -0 chmod 0775
find /usr/local/share/nvim -type f -print0 | xargs -0 chmod 0664

pip3 install neovim msgpack
"""

exports = [
  '/usr/local/bin/nvim',
  '/usr/local/include/python3.6/',
  '/usr/local/lib/python3.6/',
  '/usr/local/share/nvim/',
]

docs = [
  '/usr/local/share/man/man1/nvim.1'
]
