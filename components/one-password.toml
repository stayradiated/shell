# names can't start with a number
name = "one-password"
from = "base"

# https://releases.1password.com/linux/
version = '8.10.70-24'

devDependencies = [ "apteryx" ]

build = """
curl -sS https://downloads.1password.com/linux/keys/1password.asc \
  | gpg --dearmor --output /usr/share/keyrings/1password-archive-keyring.gpg

# # STABLE
# echo 'deb [arch=amd64 signed-by=/usr/share/keyrings/1password-archive-keyring.gpg] https://downloads.1password.com/linux/debian/amd64 stable main' \
#   | tee /etc/apt/sources.list.d/1password.list

# BETA
echo 'deb [arch=amd64 signed-by=/usr/share/keyrings/1password-archive-keyring.gpg] https://downloads.1password.com/linux/debian/amd64 beta main' \
  | tee /etc/apt/sources.list.d/1password.list

mkdir -p /etc/debsig/policies/AC2D62742012EA22/

curl -sS https://downloads.1password.com/linux/debian/debsig/1password.pol \
  | tee /etc/debsig/policies/AC2D62742012EA22/1password.pol

mkdir -p /usr/share/debsig/keyrings/AC2D62742012EA22

curl -sS https://downloads.1password.com/linux/keys/1password.asc \
  | gpg --dearmor --output /usr/share/debsig/keyrings/AC2D62742012EA22/debsig.gpg

apt update

# replace dash with tilde
version=$(echo "{{VERSION}}" | sed 's/-/~/')

apteryx 1password="${version}.BETA"
"""

exports = [
  "/etc/alternatives/open",
  "/etc/alternatives/open.1.gz",
  "/etc/gtk-3.0/",
  "/etc/systemd/user/sockets.target.wants/keyboxd.socket",
  "/etc/X11/xkb",
  "/etc/X11/Xsession.d/20dbus_xdg-runtime",
  "/opt/1Password/",
  "/usr/bin/1password",
  "/usr/bin/browse",
  "/usr/bin/gpg2",
  "/usr/bin/gpgparsemail",
  "/usr/bin/gpgsm",
  "/usr/bin/gpgsplit",
  "/usr/bin/gpgtar",
  "/usr/bin/gtk-update-icon-cache",
  "/usr/bin/kbxutil",
  "/usr/bin/lspgpot",
  "/usr/bin/migrate-pubring-from-classic-gpg",
  "/usr/bin/open",
  "/usr/bin/update-mime-database",
  "/usr/bin/watchgnupg",
  "/usr/bin/xdg-desktop-icon",
  "/usr/bin/xdg-desktop-menu",
  "/usr/bin/xdg-email",
  "/usr/bin/xdg-icon-resource",
  "/usr/bin/xdg-mime",
  "/usr/bin/xdg-open",
  "/usr/bin/xdg-screensaver",
  "/usr/bin/xdg-settings",
  "/usr/lib/gnupg/gpg-pair-tool",
  "/usr/lib/gnupg/keyboxd",
  "/usr/lib/systemd/user/dbus.service",
  "/usr/lib/systemd/user/dbus.socket",
  "/usr/lib/systemd/user/dconf.service",
  "/usr/lib/systemd/user/keyboxd.service",
  "/usr/lib/systemd/user/keyboxd.socket",
  "/usr/lib/systemd/user/sockets.target.wants/",
  "/usr/lib/x86_64-linux-gnu/avahi/",
  "/usr/lib/x86_64-linux-gnu/gdk-pixbuf-2.0/",
  "/usr/lib/x86_64-linux-gnu/gio/modules/giomodule.cache",
  "/usr/lib/x86_64-linux-gnu/gio/modules/libdconfsettings.so",
  "/usr/lib/x86_64-linux-gnu/gtk-3.0/",
  "/usr/lib/x86_64-linux-gnu/libasound.so.2",
  "/usr/lib/x86_64-linux-gnu/libatk-1.0.so.0",
  "/usr/lib/x86_64-linux-gnu/libatk-1.0.so.0.25209.1",
  "/usr/lib/x86_64-linux-gnu/libatk-bridge-2.0.so.0",
  "/usr/lib/x86_64-linux-gnu/libatk-bridge-2.0.so.0.0.0",
  "/usr/lib/x86_64-linux-gnu/libatspi.so.0",
  "/usr/lib/x86_64-linux-gnu/libatspi.so.0.0.1",
  "/usr/lib/x86_64-linux-gnu/libavahi-client.so.3",
  "/usr/lib/x86_64-linux-gnu/libavahi-client.so.3.2.9",
  "/usr/lib/x86_64-linux-gnu/libavahi-common.so.3",
  "/usr/lib/x86_64-linux-gnu/libavahi-common.so.3.5.4",
  "/usr/lib/x86_64-linux-gnu/libcairo-gobject.so.2",
  "/usr/lib/x86_64-linux-gnu/libcairo-gobject.so.2.11800.0",
  "/usr/lib/x86_64-linux-gnu/libcairo.so.2",
  "/usr/lib/x86_64-linux-gnu/libcairo.so.2.11800.0",
  "/usr/lib/x86_64-linux-gnu/libcolord.so.2",
  "/usr/lib/x86_64-linux-gnu/libcolord.so.2.0.5",
  "/usr/lib/x86_64-linux-gnu/libcolordprivate.so.2",
  "/usr/lib/x86_64-linux-gnu/libcolordprivate.so.2.0.5",
  "/usr/lib/x86_64-linux-gnu/libcups.so.2",
  "/usr/lib/x86_64-linux-gnu/libdatrie.so.1",
  "/usr/lib/x86_64-linux-gnu/libdatrie.so.1.4.0",
  "/usr/lib/x86_64-linux-gnu/libdconf.so.1",
  "/usr/lib/x86_64-linux-gnu/libdconf.so.1.0.0",
  "/usr/lib/x86_64-linux-gnu/libdeflate.so.0",
  "/usr/lib/x86_64-linux-gnu/libdrm.so.2",
  "/usr/lib/x86_64-linux-gnu/libdrm.so.2.4.0",
  "/usr/lib/x86_64-linux-gnu/libepoxy.so.0",
  "/usr/lib/x86_64-linux-gnu/libepoxy.so.0.0.0",
  "/usr/lib/x86_64-linux-gnu/libfontconfig.so.1",
  "/usr/lib/x86_64-linux-gnu/libfontconfig.so.1.12.1",
  "/usr/lib/x86_64-linux-gnu/libfreebl3.chk",
  "/usr/lib/x86_64-linux-gnu/libfreebl3.so",
  "/usr/lib/x86_64-linux-gnu/libfreeblpriv3.chk",
  "/usr/lib/x86_64-linux-gnu/libfreeblpriv3.so",
  "/usr/lib/x86_64-linux-gnu/libfreetype.so.6",
  "/usr/lib/x86_64-linux-gnu/libfreetype.so.6.20.1",
  "/usr/lib/x86_64-linux-gnu/libfribidi.so.0",
  "/usr/lib/x86_64-linux-gnu/libfribidi.so.0.4.0",
  "/usr/lib/x86_64-linux-gnu/libgbm.so.1",
  "/usr/lib/x86_64-linux-gnu/libgbm.so.1.0.0",
  "/usr/lib/x86_64-linux-gnu/libgdk_pixbuf-2.0.so.0",
  "/usr/lib/x86_64-linux-gnu/libgdk_pixbuf-2.0.so.0.4200.10",
  "/usr/lib/x86_64-linux-gnu/libgdk-3.so.0",
  "/usr/lib/x86_64-linux-gnu/libgdk-3.so.0.2409.32",
  "/usr/lib/x86_64-linux-gnu/libgraphite2.so.2.0.0",
  "/usr/lib/x86_64-linux-gnu/libgraphite2.so.3",
  "/usr/lib/x86_64-linux-gnu/libgraphite2.so.3.2.1",
  "/usr/lib/x86_64-linux-gnu/libgtk-3-0t64/",
  "/usr/lib/x86_64-linux-gnu/libgtk-3.so.0",
  "/usr/lib/x86_64-linux-gnu/libgtk-3.so.0.2409.32",
  "/usr/lib/x86_64-linux-gnu/libharfbuzz.so.0",
  "/usr/lib/x86_64-linux-gnu/libharfbuzz.so.0.60830.0",
  "/usr/lib/x86_64-linux-gnu/libjbig.so.0",
  "/usr/lib/x86_64-linux-gnu/libjpeg.so.8",
  "/usr/lib/x86_64-linux-gnu/libjpeg.so.8.2.2",
  "/usr/lib/x86_64-linux-gnu/liblcms2.so.2",
  "/usr/lib/x86_64-linux-gnu/liblcms2.so.2.0.14",
  "/usr/lib/x86_64-linux-gnu/libLerc.so.4",
  "/usr/lib/x86_64-linux-gnu/libnotify.so.4",
  "/usr/lib/x86_64-linux-gnu/libnotify.so.4.0.0",
  "/usr/lib/x86_64-linux-gnu/libnspr4.so",
  "/usr/lib/x86_64-linux-gnu/libnss3.so",
  "/usr/lib/x86_64-linux-gnu/libnssckbi.so",
  "/usr/lib/x86_64-linux-gnu/libnssdbm3.chk",
  "/usr/lib/x86_64-linux-gnu/libnssdbm3.so",
  "/usr/lib/x86_64-linux-gnu/libnssutil3.so",
  "/usr/lib/x86_64-linux-gnu/liboss4-salsa.so.2",
  "/usr/lib/x86_64-linux-gnu/liboss4-salsa.so.2.0.0",
  "/usr/lib/x86_64-linux-gnu/libpango-1.0.so.0",
  "/usr/lib/x86_64-linux-gnu/libpango-1.0.so.0.5200.1",
  "/usr/lib/x86_64-linux-gnu/libpangocairo-1.0.so.0",
  "/usr/lib/x86_64-linux-gnu/libpangocairo-1.0.so.0.5200.1",
  "/usr/lib/x86_64-linux-gnu/libpangoft2-1.0.so.0",
  "/usr/lib/x86_64-linux-gnu/libpangoft2-1.0.so.0.5200.1",
  "/usr/lib/x86_64-linux-gnu/libpixman-1.so.0",
  "/usr/lib/x86_64-linux-gnu/libpixman-1.so.0.42.2",
  "/usr/lib/x86_64-linux-gnu/libplc4.so",
  "/usr/lib/x86_64-linux-gnu/libplds4.so",
  "/usr/lib/x86_64-linux-gnu/libpng16.so.16",
  "/usr/lib/x86_64-linux-gnu/libpng16.so.16.43.0",
  "/usr/lib/x86_64-linux-gnu/libsharpyuv.so.0",
  "/usr/lib/x86_64-linux-gnu/libsharpyuv.so.0.0.1",
  "/usr/lib/x86_64-linux-gnu/libsmime3.so",
  "/usr/lib/x86_64-linux-gnu/libsoftokn3.chk",
  "/usr/lib/x86_64-linux-gnu/libsoftokn3.so",
  "/usr/lib/x86_64-linux-gnu/libssl3.so",
  "/usr/lib/x86_64-linux-gnu/libthai.so.0",
  "/usr/lib/x86_64-linux-gnu/libthai.so.0.3.1",
  "/usr/lib/x86_64-linux-gnu/libtiff.so.6",
  "/usr/lib/x86_64-linux-gnu/libtiff.so.6.0.1",
  "/usr/lib/x86_64-linux-gnu/libwayland-client.so.0",
  "/usr/lib/x86_64-linux-gnu/libwayland-client.so.0.22.0",
  "/usr/lib/x86_64-linux-gnu/libwayland-cursor.so.0",
  "/usr/lib/x86_64-linux-gnu/libwayland-cursor.so.0.22.0",
  "/usr/lib/x86_64-linux-gnu/libwayland-egl.so.1",
  "/usr/lib/x86_64-linux-gnu/libwayland-egl.so.1.22.0",
  "/usr/lib/x86_64-linux-gnu/libwayland-server.so.0",
  "/usr/lib/x86_64-linux-gnu/libwayland-server.so.0.22.0",
  "/usr/lib/x86_64-linux-gnu/libwebp.so.7",
  "/usr/lib/x86_64-linux-gnu/libwebp.so.7.1.8",
  "/usr/lib/x86_64-linux-gnu/libX11.so.6",
  "/usr/lib/x86_64-linux-gnu/libX11.so.6.4.0",
  "/usr/lib/x86_64-linux-gnu/libXau.so.6",
  "/usr/lib/x86_64-linux-gnu/libXau.so.6.0.0",
  "/usr/lib/x86_64-linux-gnu/libxcb-randr.so.0",
  "/usr/lib/x86_64-linux-gnu/libxcb-randr.so.0.1.0",
  "/usr/lib/x86_64-linux-gnu/libxcb-render.so.0",
  "/usr/lib/x86_64-linux-gnu/libxcb-render.so.0.0.0",
  "/usr/lib/x86_64-linux-gnu/libxcb-shape.so.0",
  "/usr/lib/x86_64-linux-gnu/libxcb-shape.so.0.0.0",
  "/usr/lib/x86_64-linux-gnu/libxcb-shm.so.0",
  "/usr/lib/x86_64-linux-gnu/libxcb-shm.so.0.0.0",
  "/usr/lib/x86_64-linux-gnu/libxcb-xfixes.so.0",
  "/usr/lib/x86_64-linux-gnu/libxcb-xfixes.so.0.0.0",
  "/usr/lib/x86_64-linux-gnu/libxcb.so.1",
  "/usr/lib/x86_64-linux-gnu/libxcb.so.1.1.0",
  "/usr/lib/x86_64-linux-gnu/libXcomposite.so.1",
  "/usr/lib/x86_64-linux-gnu/libXcomposite.so.1.0.0",
  "/usr/lib/x86_64-linux-gnu/libXcursor.so.1",
  "/usr/lib/x86_64-linux-gnu/libXcursor.so.1.0.2",
  "/usr/lib/x86_64-linux-gnu/libXdamage.so.1",
  "/usr/lib/x86_64-linux-gnu/libXdamage.so.1.1.0",
  "/usr/lib/x86_64-linux-gnu/libXdmcp.so.6",
  "/usr/lib/x86_64-linux-gnu/libXdmcp.so.6.0.0",
  "/usr/lib/x86_64-linux-gnu/libXext.so.6",
  "/usr/lib/x86_64-linux-gnu/libXext.so.6.4.0",
  "/usr/lib/x86_64-linux-gnu/libXfixes.so.3",
  "/usr/lib/x86_64-linux-gnu/libXfixes.so.3.1.0",
  "/usr/lib/x86_64-linux-gnu/libXi.so.6",
  "/usr/lib/x86_64-linux-gnu/libXi.so.6.1.0",
  "/usr/lib/x86_64-linux-gnu/libXinerama.so.1",
  "/usr/lib/x86_64-linux-gnu/libXinerama.so.1.0.0",
  "/usr/lib/x86_64-linux-gnu/libxkbcommon.so.0",
  "/usr/lib/x86_64-linux-gnu/libxkbcommon.so.0.0.0",
  "/usr/lib/x86_64-linux-gnu/libXrandr.so.2",
  "/usr/lib/x86_64-linux-gnu/libXrandr.so.2.2.0",
  "/usr/lib/x86_64-linux-gnu/libXrender.so.1",
  "/usr/lib/x86_64-linux-gnu/libXrender.so.1.3.0",
  "/usr/lib/x86_64-linux-gnu/libxshmfence.so.1",
  "/usr/lib/x86_64-linux-gnu/libxshmfence.so.1.0.0",
  "/usr/lib/x86_64-linux-gnu/oss4-libsalsa/",
  "/usr/libexec/dconf-service",
  "/usr/local/share/fonts",
  "/usr/sbin/addgnupghome",
  "/usr/sbin/applygnupgdefaults",
  "/usr/sbin/update-icon-caches",
  "/usr/share/apport/package-hooks/source_fontconfig.py",
  "/usr/share/bug/libgbm1/",
  "/usr/share/bug/libgtk-3-0t64/",
  "/usr/share/bug/xdg-utils/",
  "/usr/share/dbus-1/services/ca.desrt.dconf.service",
  "/usr/share/doc-base/fontconfig.fontconfig-user",
  "/usr/share/doc-base/libpng16-16t64.libpng16",
  "/usr/share/doc-base/shared-mime-info.shared-mime-info",
  "/usr/share/fontconfig/",
  "/usr/share/gettext/",
  "/usr/share/glib-2.0/schemas/gschemas.compiled",
  "/usr/share/glib-2.0/schemas/org.gtk.Settings.ColorChooser.gschema.xml",
  "/usr/share/glib-2.0/schemas/org.gtk.Settings.Debug.gschema.xml",
  "/usr/share/glib-2.0/schemas/org.gtk.Settings.EmojiChooser.gschema.xml",
  "/usr/share/glib-2.0/schemas/org.gtk.Settings.FileChooser.gschema.xml",
  "/usr/share/gtk-3.0/",
  "/usr/share/icons/Adwaita/",
  "/usr/share/icons/default/",
  "/usr/share/icons/hicolor/128x128/",
  "/usr/share/icons/hicolor/16x16/",
  "/usr/share/icons/hicolor/192x192/",
  "/usr/share/icons/hicolor/22x22/",
  "/usr/share/icons/hicolor/24x24/",
  "/usr/share/icons/hicolor/256x256/",
  "/usr/share/icons/hicolor/32x32/",
  "/usr/share/icons/hicolor/36x36/",
  "/usr/share/icons/hicolor/48x48/actions",
  "/usr/share/icons/hicolor/48x48/animations",
  "/usr/share/icons/hicolor/48x48/apps/1password.png",
  "/usr/share/icons/hicolor/48x48/categories",
  "/usr/share/icons/hicolor/48x48/devices",
  "/usr/share/icons/hicolor/48x48/emblems",
  "/usr/share/icons/hicolor/48x48/emotes",
  "/usr/share/icons/hicolor/48x48/filesystems",
  "/usr/share/icons/hicolor/48x48/intl",
  "/usr/share/icons/hicolor/48x48/mimetypes",
  "/usr/share/icons/hicolor/48x48/places",
  "/usr/share/icons/hicolor/48x48/status",
  "/usr/share/icons/hicolor/48x48/stock/",
  "/usr/share/icons/hicolor/512x512/",
  "/usr/share/icons/hicolor/64x64/",
  "/usr/share/icons/hicolor/72x72/",
  "/usr/share/icons/hicolor/96x96/",
  "/usr/share/icons/hicolor/icon-theme.cache",
  "/usr/share/icons/hicolor/index.theme",
  "/usr/share/icons/hicolor/scalable/actions",
  "/usr/share/icons/hicolor/scalable/animations",
  "/usr/share/icons/hicolor/scalable/categories",
  "/usr/share/icons/hicolor/scalable/devices",
  "/usr/share/icons/hicolor/scalable/emblems",
  "/usr/share/icons/hicolor/scalable/emotes",
  "/usr/share/icons/hicolor/scalable/filesystems",
  "/usr/share/icons/hicolor/scalable/intl",
  "/usr/share/icons/hicolor/scalable/mimetypes",
  "/usr/share/icons/hicolor/scalable/places",
  "/usr/share/icons/hicolor/scalable/status",
  "/usr/share/icons/hicolor/scalable/stock/",
  "/usr/share/icons/hicolor/symbolic/",
  "/usr/share/icons/Humanity-Dark/",
  "/usr/share/icons/Humanity/",
  "/usr/share/icons/LoginIcons/",
  "/usr/share/icons/ubuntu-mono-dark/",
  "/usr/share/icons/ubuntu-mono-light/",
  "/usr/share/info/gnupg-card-architecture.png",
  "/usr/share/info/gnupg-module-overview.png",
  "/usr/share/info/gnupg.info-1.gz",
  "/usr/share/info/gnupg.info-2.gz",
  "/usr/share/info/gnupg.info-3.gz",
  "/usr/share/info/gnupg.info.gz",
  "/usr/share/keyrings/1password-archive-keyring.gpg",
  "/usr/share/libdrm/",
  "/usr/share/libthai/",
  "/usr/share/mime/",
  "/usr/share/polkit-1/actions/com.1password.1Password.policy",
  "/usr/share/themes/",
  "/usr/share/X11/",
  "/usr/share/xml/fontconfig/",
  "/var/cache/fontconfig/",
  "/var/lib/systemd/deb-systemd-user-helper-enabled/keyboxd.socket.dsh-also",
  "/var/lib/systemd/deb-systemd-user-helper-enabled/sockets.target.wants/keyboxd.socket"
]

[checkUpdates]
  type = 'json'
  url = 'https://freecrayon-getLatest1PasswordLinuxBetaVersion.web.val.run'
  path = ['version']

[diff]
exclude = [
  "/etc/alternatives/x-cursor-theme",
  "/etc/apt/sources.list.d/1password.list",
  "/etc/dconf/",
  "/etc/debsig/",
  "/etc/fonts/",
  "/etc/group",
  "/etc/group-",
  "/etc/gshadow",
  "/etc/gshadow-",
  "/etc/ld.so.cache",
  "/usr/bin/fc-cache",
  "/usr/bin/fc-cat",
  "/usr/bin/fc-conflist",
  "/usr/bin/fc-list",
  "/usr/bin/fc-match",
  "/usr/bin/fc-pattern",
  "/usr/bin/fc-query",
  "/usr/bin/fc-scan",
  "/usr/bin/fc-validate",
  "/usr/local/share/fonts/",
  "/usr/share/applications/1password.desktop",
  "/usr/share/debsig/",
  "/usr/share/doc/**",
  "/usr/share/fonts/",
  "/usr/share/gnupg/help*",
  "/usr/share/lintian/**",
  "/usr/share/man/**",
  "/usr/share/pkgconfig/**",
  "/var/cache/ldconfig/aux-cache",
  "/var/lib/apt/extended_states",
  "/var/lib/apt/lists/**",
  "/var/lib/dpkg/**",
  "/var/log/**"
]
